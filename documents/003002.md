# 微任务, 宏任务 与 Event-Loop

推荐阅读:

[MDN EventLoop](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/EventLoop)

## 一. JS 运行机制

单线程, 函数执行栈, 同步任务, 异步任务, 消息队列(事件循环机制 Event Loop)

> 主线程执行栈为空呢 ? js 引擎存在 monitoring process 进程，会持续不断的检查主线程执行栈是否为空，一旦为空，就会去 Event Queue 那里检查是否有等待被调用的函数。

<p align="center"><img src=https://linmingdao.github.io/blog/assets/tech/003002_00.jpg></p>

```js
console.log("script start");

setTimeout(function () {
  console.log("setTimeout");
}, 0);

Promise.resolve()
  .then(function () {
    console.log("promise1");
  })
  .then(function () {
    console.log("promise2");
  });

console.log("script end");

// script start, script end, promise1, promise2, setTimeout
```

```js
console.log("1");

setTimeout(() => {
  console.log("2");
}, 0);

console.log("3");

new Promise((resolve, reject) => {
  resolve(1);
  console.log("4");
})
  .then((res) => {
    console.log("5");
  })
  .then((res) => {
    console.log("6");
  });

console.log("7");

// 1，3，4，7, 5, 6，2
```
